{#{% extends "templates/web.html" %}
{% from "webshop/templates/includes/order/order_macros.html" import item_name_and_description %}
{% from "templates/includes/macros.html" import product_image %}

{% block breadcrumbs %}
	{% include "templates/includes/breadcrumbs.html" %}
{% endblock %}

{% block title %}
	{{ doc.name }}
{% endblock %}

{% block header %}
 <style>
  .product-banner {
    background: linear-gradient(90deg, #570987, #2d2c2c);
    color: #ffffff;
    padding: 4rem 0;
}
.breadcrumb_a a {
    font-size: 1rem;
    color: #ffffff;
    font-weight: 700;
    text-decoration: none;
     /*opacity: 0.8; */
    transition: opacity 0.3s ease;
}
 
.breadcrumb_a span {
    margin: 0 9px;
    color: #ffffff;
}
 
.product-banner-title {
    font-size: 3rem;
    font-weight: 700;
    margin: 0;
    border-top: 1px solid rgba(255, 255, 255, 0.4);
    padding-top: 2rem;
}
</style>
<section class="product-banner mb-5">
<div class="container-fluid">
  <nav class="breadcrumb_a">
<a href="/">Home</a> <span>/</span> <a href="/all-products">All Products</a><span>/</span> <a href="/orders">Orders</a><span>/</span> <a href="">{{ doc.name }}</a>
</nav>
<h1 class="product-banner-title">{{ doc.name }}</h1>
</div>
</section>
{% endblock %}


{% block page_content %}
	<div class="container pb-6">
		 <div class="card shadow-sm mb-4">
    <div class="card-body row align-items-center">
      <div class="col-md-6 mb-2">
        <div class="badge bg-info text-light p-2 px-3 text-uppercase me-2">
          {{ _(doc.get('indicator_title')) or _(doc.status) or _("Submitted") }}
        </div>
        <div class="text-muted mt-2 small">
          {{ frappe.utils.format_date(doc.transaction_date, "medium") }}
          {% if doc.valid_till %}
            • {{ _("Valid Till") }}: {{ frappe.utils.format_date(doc.valid_till, "medium") }}
          {% endif %}
        </div>
      </div>
      <div class="col-md-6 text-end">
        <h5 class="mb-0">
          {%- set party_name = doc.supplier_name if doc.doctype in ['Supplier Quotation', 'Purchase Invoice', 'Purchase Order'] else doc.customer_name -%}
          {{ party_name }}
        </h5>
        {% if doc.contact_display and doc.contact_display != party_name %}
        <div class="text-muted small">{{ doc.contact_display }}</div>
        {% endif %}
        {% if enabled_checkout and (doc.doctype != "Sales Invoice" or doc.outstanding_amount > 0) %}
          <a href="/api/method/erpnext.accounts.doctype.payment_request.payment_request.make_payment_request?dn={{ doc.name }}&dt={{ doc.doctype }}&submit_doc=1&order_type=Shopping Cart" class="btn btn-sm btn-success mt-2">
            {{ _("Pay") }} {{ doc.get_formatted("grand_total") }}
          </a>
        {% endif %}
      </div>
    </div>
  </div>

		{% if doc._header %}
			{{ doc._header }}
		{% endif %}
  		
  		<style>
			.order-item-row:hover {
				background-color: #f9f9f9;
			}
			.order-image img {
				max-width: 60px;
				max-height: 60px;
				object-fit: cover;
				border-radius: 4px;
			}

		</style>
		<div class="order-container mt-4">
			<div class="card shadow-sm">
				<div class="card-header bg-light text-muted font-weight-bold">
					<div class="row">
						<div class="col-md-5">{{ _("Item") }}</div>
						<div class="col-md-3">{{ _("Quantity") }}</div>
						<div class="col-md-2">{{ _("Rate") }}</div>
						<div class="col-md-2 text-right">{{ _("Amount") }}</div>
					</div>
				</div>
				<div class="card-body p-0">
					{% for d in doc.items %}
					<div class="row align-items-center py-3 px-3 border-bottom order-item-row">
						<div class="col-md-5">
							<div class="d-flex align-items-start">
								<div class="order-image mr-2">
									{% set website_item_list = frappe.get_all("Website Item", filters={"item_code": d.item_code}, limit=1) %}
									{% if website_item_list %}
										{% set website_item = frappe.get_doc("Website Item", website_item_list[0].name) %}
										{% if website_item.website_image %}
											{{ product_image(website_item.website_image, no_border=True) }}
										{% endif %}
									{% else %}
										<div class="no-image-cart-item bg-secondary text-white text-center rounded" style="width: 60px; height: 60px;">
											{{ frappe.utils.get_abbr(d.item_name) or "NA" }}
										</div>
									{% endif %}
								</div>
								<div>
									<strong>{{ d.item_code }}</strong>
									<div class="text-muted small">
										{{ html2text(d.description or "") | truncate(100) }}
									</div>
								</div>
							</div>
						</div>
						<div class="col-md-3">{{ d.get_formatted("qty") }}</div>
						<div class="col-md-2">{{ d.get_formatted("rate") }}</div>
						<div class="col-md-2 text-right font-weight-bold">{{ d.get_formatted("amount") }}</div>
					</div>
					{% endfor %}
				</div>
			</div>
		</div>


			<!-- taxes -->
			<div class="">
				{% include "webshop/templates/includes/order/order_taxes.html" %}
			</div>
		</div>
	</div>

	{% if enabled_checkout and ((doc.doctype=="Sales Order" and doc.per_billed <= 0)
		or (doc.doctype=="Sales Invoice" and doc.outstanding_amount> 0)) %}
		<div class="panel panel-default">
			<div class="panel-collapse">
				<div class="panel-body text-muted small">
					<div class="row">
						<div class="form-column col-sm-6">
							{% if available_loyalty_points %}
							<div class="panel-heading">
								<div class="row">
									<div class="form-column col-sm-6 address-title">
										<strong>Loyalty Points</strong>
									</div>
								</div>
							</div>

							<div class="form-group">
								<div class="h6">Enter Loyalty Points</div>
								<div class="control-input-wrapper">
									<div class="control-input">
										<input class="form-control" type="number" min="0"
											max="{{ available_loyalty_points }}" id="loyalty-point-to-redeem">
									</div>
									<p class="help-box small text-muted d-none d-sm-block"> Available Points: {{
										available_loyalty_points }} </p>
								</div>
							</div>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</div>
	{% endif %}


	{% if attachments %}
		<div class="order-item-table">
			<div class="row order-items order-item-header text-muted">
				<div class="col-sm-12 h6 text-uppercase">
					{{ _("Attachments") }}
				</div>
			</div>
			<div class="row order-items">
				<div class="col-sm-12">
					{% for attachment in attachments %}
					<p class="small">
						<a href="{{ attachment.file_url }}" target="blank"> {{ attachment.file_name }} </a>
					</p>
					{% endfor %}
				</div>
			</div>
		</div>
	{% endif %}

	{% if doc.terms %}
		<div class="terms-and-condition text-muted small">
			<hr>
			<p>{{ doc.terms }}</p>
		</div>
	{% endif %}
{% endblock %}#}

{% extends "templates/web.html" %}
{% from "webshop/templates/includes/order/order_macros.html" import item_name_and_description %}
{% from "templates/includes/macros.html" import product_image %}

{% block breadcrumbs %}
    {% include "templates/includes/breadcrumbs.html" %}
{% endblock %}

{% block title %}
    {{ doc.name }}
{% endblock %}

{% block header %}
<style>
	.product-banner {
		border-top: #cacaca 1px solid;
		/* background: #a6a6a6; */
		color: #000;
		padding: 4rem 0;
	}

	.breadcrumb_a a {
		font-size: 1rem;
		color: #000;
		font-weight: 700;
		text-decoration: none;
		/*opacity: 0.8; */
		transition: opacity 0.3s ease;
	}

	.breadcrumb_a span {
		margin: 0 9px;
		color: #000;
	}

	.product-banner-title {
		font-size: 3rem;
		font-weight: 700;
		margin: 0;
		/* border-top: 1px solid #cacaca; */
		/* padding-top: 2rem; */
	}

	.cart-container .cart-table tr {
		padding: 10px !important;
		display: flex;
	}

	.cart-container .cart-table td {
		/* border-color: var(--border-color); */
		border-width: 0 !important;

	}

	.marign {
		margin-left: 40px !important;
	}

	@media (max-width: 767px) {
		.marign {
			margin-left: 0px !important;
		}
	}

	a.btn.btn-primary-light.font-md {
		inline-size: max-content !important;
	}

	.product-banner {
		border-top: #cacaca 1px solid;
		/* background: #a6a6a6; */
		color: #000;
		padding: 4rem 0;
	}

	.breadcrumb_a a {
		font-size: 1rem;
		color: #000;
		font-weight: 700;
		text-decoration: none;
		/*opacity: 0.8; */
		transition: opacity 0.3s ease;
	}

	.breadcrumb_a span {
		margin: 0 9px;
		color: #000;
	}

	.product-banner-title {
		font-size: 3rem;
		font-weight: 700;
		margin: 0;
		/* border-top: 1px solid #cacaca; */
		/* padding-top: 2rem; */
		padding-left: 10px;
		padding-right: 10px;
	}


	/* Banner Wrapper */
	.product-banner {
		padding: 40px 0;
		border-bottom: 1px solid #e5e7eb;
	}

	/* Breadcrumb */
	.breadcrumb_a {
		font-size: 14px;
		color: #6b7280;
		margin-bottom: 10px;
		padding-left: 10px;
		padding-right: 10px;
	}

	.breadcrumb_a a {
		color: #4b5563;
		text-decoration: none;
		transition: 0.2s ease-in-out;
	}

	.breadcrumb_a a:hover {
		color: #111827;
		text-decoration: underline;
	}

	.breadcrumb_a span {
		margin: 0 6px;
		color: #9ca3af;
	}

	/* Page Title */
	.product-banner-title {
		font-size: 40px !important;
		font-weight: 500 !important;
		color: #111827;
		/* margin-top: 5px; */
		letter-spacing: -0.5px;
	}
</style>
<section class="product-banner mb-5">
    <div>
        <nav class="breadcrumb_a">
            <a href="/">Home</a> <span>/</span> 
            <a href="/all-products">All Products</a> <span>/</span> 
            <!-- <a href="/orders">Orders</a><span>/</span>  -->
            <a href="">{{ doc.name }}</a>
        </nav>
        	<div class="p-0" style="
border-top: 40px solid #e4002c;
    position: relative;
    ">
        <h1 class="product-banner-title">{{ doc.name }}</h1>
    </div>
</section>
{% endblock %}
{% block page_content %}
<style>
    .order-page {
        background-color: #f2f2f2;
        color: white;
        font-family: 'Segoe UI', sans-serif;
		border-radius: 8px;
		padding: 20px;
    }
    .header-bar {
        display: inline;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background: #ffffff;
		border-radius: 8px;
		color: black;
    }
    .header-left .btn-orange {
        background-color: orange;
        color: white;
        font-weight: bold;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 6px;
    }
    .header-right .admin-label {
        color: white;
        font-weight: bold;
        margin-right: 1rem;
    }
    .header-right .btn-orange {
        background-color: orange;
        color: black;
        font-weight: bold;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 6px;
    }
    .items-table {
       border-collapse: separate;
        border-spacing: 0;
        border-radius: 12px !important;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
       /* margin-top: 2rem;*/
        background: #fff;
        color: white;
        border: 2px solid #ddd;

    }
    .items-table thead {
        border: 1px solid #444;
        font-weight: bold;
    }
	.items-table th {
        padding: 1rem;
        vertical-align: middle;
		/* background: #590088; */
    }
    .items-table td{
        padding: 1rem;
        vertical-align: middle;
		background: #ffffff;
		color: black;
    }
    .items-table tr{
		border-bottom: 1px solid #ddd;
	}
    .item-img {
        width: 100px;
        height: 100px;
        border-radius: 6px;
        margin-right: 1rem;
        object-fit: cover;
    }
    .summary-totals {
        margin-top: 2rem;
        padding: 1rem;
        border-top: 1px solid #555;
        color: black;
        font-size: 1rem;
    }
    .summary-totals div {
		color: black;
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
    }
	.order-taxes {
		color: #000;
		border-radius: 8px;
	}
.payment-section {
  background-color: #1e1b2e;
  color: #ffffff;
  padding: 20px;
  border-radius: 8px;
}
.btn-primary {
  background-color: #6a0dad;
  border-color: #6a0dad;
}
.card-icons i {
  margin-left: 5px;
  font-size: 1.2em;
  color: #ccc;
}
.payment-container {
  display: flex;
  justify-content: space-between;
  background-color: #ffffff;
  color: #000000;
  padding: 20px;
  border-radius: 10px;
  gap: 30px;
  flex-wrap: wrap;
}

.payment-methods, .billing-summary {
  flex: 1;
  min-width: 300px;
}

.balance-input {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

input[type="text"], select {
  padding: 8px;
  border-radius: 5px;
  border: none;
  width: 100%;
}

.apply-btn, .pay-btn {
  background-color: black !;
  color: white;
  border: none;
  padding: 10px 16px;
  border-radius: 5px;
  cursor: pointer;
}

.method-group {
  margin-top: 20px;
}

.method-group h4 {
  margin-bottom: 10px;
  color: #5b0089;
}

.method-group label {
  display: block;
  margin-bottom: 8px;
}

.bank-select {
  margin-top: 8px;
  width: 100%;
}

.billing-summary h4 {
  margin-bottom: 15px;
  color: #c3a6ff;
}

.item-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
}

.disabled label {
  color: #888;
}
.card {
  background-color: #1e1b2e;
  color: #fff;
}

.badge {
  background-color: transparent;
  border-color: #6a0dad;
  color: #6a0dad;
}

.btn:hover {
  background-color: #4fd1c5 !important;
}
.payment-container {
  background-color: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  padding: 1.5rem;
  font-family: 'Inter', sans-serif;
}

/* Section Headings */
.payment-container h2 {
  font-size: 18px;
  font-weight: 700;
  color: #4c1d95; /* purple accent */
  margin-bottom: 0.5rem;
}

.payment-container h4 {
  font-size: 16px;
  font-weight: 600;
  color: #111827;
  margin-bottom: 0.75rem;
}

/* Balance Section */
.balance-section label {
  font-size: 0.9rem;
  color: #6b7280;
  display: block;
  margin-bottom: 0.25rem;
}

.balance-input {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.5rem;
}

.balance-input input {
  flex: 1;
  border: 1px solid #d1d5db !important;
  border-radius: 6px;
  padding: 0.5rem 0.75rem;
  font-size: 0.9rem;
}

.apply-btn {
  background-color: #4c1d95;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.apply-btn:hover {
  background-color: #3b0764;
}

/* Payment Methods Layout */
.payment-methods {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-top: 1.5rem;
}

/* Each method group styled as a card */
.payment-methods .method-group {
  flex: 1 1 300px;
  min-width: 280px;
  background-color: #f9fafb;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 1rem;
  box-shadow: inset 0 0 0.5px rgba(0,0,0,0.05);
}

/* Radio labels */
.payment-methods .method-group label {
  display: block;
  font-size: 0.9rem;
  color: #374151;
  margin-bottom: 0.5rem;
  cursor: pointer;
}

/* Radio inputs */
.payment-methods .method-group input[type="radio"] {
  margin-right: 0.5rem;
  accent-color: #4c1d95;
}

/* Disabled Option */
.payment-methods .method-group.disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
.payment-methods {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

/* Top section stays full width */
.balance-section {
  order: 0;
}

/* Wrap UPI + Other Payment Methods side by side */
.payment-methods .method-group:nth-of-type(2),
.payment-methods .method-group:nth-of-type(3) {
  order: 1;
  display: inline-block;
  vertical-align: top;
  width: calc(50% - 1rem);
  background-color: #f9fafb;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 1rem;
  box-sizing: border-box;
}

/* Cash on Delivery stays full width at bottom */
.payment-methods .method-group.disabled {
  order: 2;
  width: 100%;
  opacity: 0.6;
  cursor: not-allowed;
  margin-top: 1rem;
}

/* Headings and labels */
.payment-methods h2 {
  font-size: 18px;
  font-weight: 700;
  color:#000;
  margin-bottom: 0.5rem;
}

.payment-methods h4 {
  font-size: 16px;
  font-weight: 600;
  color: #111827;
  margin-bottom: 0.75rem;
}

.payment-methods label {
  display: block;
  font-size: 0.9rem;
  color: #374151;
  margin-bottom: 0.5rem;
  cursor: pointer;
}

.payment-methods input[type="radio"] {
  margin-right: 0.5rem;
  accent-color: #4c1d95;
}

/* Balance input styling */
.balance-input {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.5rem;
}

.balance-input input {
  flex: 1;
  border: 1px solid #d1d5db !important;
  border-radius: 6px;
  padding: 0.5rem 0.75rem;
  font-size: 0.9rem;
}

.apply-btn {
  background-color: #000;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.apply-btn:hover {
  background-color: #3b0764;
}
.payment-methods .method-group:nth-of-type(1) {
  flex: 1 1 300px;
  min-width: 280px;
  height: 185px;
  background-color: #ffffff;
  border: 2px solid #d1d5db;
  border-radius: 10px;
  padding: 1rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}
/* 
.payment-methods .method-group:nth-of-type(1):hover {
  border-color: black;
  box-shadow: 0 4px 12px rgba(76, 29, 149, 0.1);
} */

.payment-methods .method-group:nth-of-type(1) h4 {
  font-size: 16px;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 0.75rem;
  border-bottom: 1px solid #e5e7eb;
  padding-bottom: 0.25rem;
}

.payment-methods .method-group:nth-of-type(1) label {
  display: block;
  font-size: 0.9rem;
  color: #374151;
  margin-bottom: 0.5rem;
  cursor: pointer;
}

.payment-methods .method-group:nth-of-type(1) input[type="radio"] {
  margin-right: 0.5rem;
  accent-color: #4c1d95;
}

.payment-methods .method-group:nth-of-type(2) {
  flex: 1 1 300px;
  min-width: 280px;
  height: 185px;
  background-color: #ffffff;
  border: 2px solid #d1d5db;
  border-radius: 10px;
  padding: 1rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

/* .payment-methods .method-group:nth-of-type(2):hover {
  border-color: black;
  box-shadow: 0 4px 12px rgba(76, 29, 149, 0.1);
} */

.payment-methods .method-group:nth-of-type(2) h4 {
  font-size: 16px;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 0.75rem;
  border-bottom: 1px solid #e5e7eb;
  padding-bottom: 0.25rem;
}

.payment-methods .method-group:nth-of-type(2) label {
  display: block;
  font-size: 0.9rem;
  color: #374151;
  margin-bottom: 0.5rem;
  cursor: pointer;
}

.payment-methods .method-group:nth-of-type(2) input[type="radio"] {
  margin-right: 0.5rem;
  accent-color: #4c1d95;
}
.payment-methods .method-group:nth-of-type(2) {
  flex: 1 1 300px;
  min-width: 280px;
  height: 185px;
  background-color: #ffffff;
  border: 2px solid #d1d5db;
  border-radius: 10px;
  padding: 1rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
  transition: 
    border-color 0.3s ease,
    box-shadow 0.3s ease,
    transform 0.25s ease,
    background-color 0.25s ease;
}
/* Shared Hover Effect for UPI & Other Payment Methods */
.payment-methods .method-group:nth-of-type(1):hover,
.payment-methods .method-group:nth-of-type(2):hover {
  /* border-color: black; */
  background-color: #f9f9f9;
  /* box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15); */
  transform: translateY(-3px);
}

/* Headings */
.payment-methods .method-group:nth-of-type(1) h4,
.payment-methods .method-group:nth-of-type(2) h4 {
  font-size: 16px;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 0.75rem;
  border-bottom: 1px solid #e5e7eb;
  padding-bottom: 0.25rem;
  transition: color 0.3s ease;
}

.payment-methods .method-group:nth-of-type(1):hover h4,
.payment-methods .method-group:nth-of-type(2):hover h4 {
  color: black;
}

/* Labels */
.payment-methods .method-group:nth-of-type(1) label,
.payment-methods .method-group:nth-of-type(2) label {
  display: block;
  font-size: 0.9rem;
  color: #374151;
  margin-bottom: 0.5rem;
  cursor: pointer;
  transition: color 0.3s ease, padding-left 0.3s ease;
}

.payment-methods .method-group:nth-of-type(1) label:hover,
.payment-methods .method-group:nth-of-type(2) label:hover {
  color: #111827;
  padding-left: 4px;
}

/* Radio inputs */
.payment-methods .method-group:nth-of-type(1) input[type="radio"],
.payment-methods .method-group:nth-of-type(2) input[type="radio"] {
  margin-right: 0.5rem;
  accent-color: black;
  transition: transform 0.2s ease;
}

.payment-methods .method-group:nth-of-type(1) input[type="radio"]:hover,
.payment-methods .method-group:nth-of-type(2) input[type="radio"]:hover {
  transform: scale(1.1);
}


</style>

<div class="order-page row mb-5">
  <div class="d-grid col-md-8 col-12 p-0">
     {% if "Corporate Buyer" not in roles %}
 <div class="payment-container rounded shadow mb-4">
  <div class="payment-methods">

    <!-- Balance Section (Top) -->
    <div class="balance-section">
      <h2 class="text-purple" style="font-size: 18px; font-weight: 700;">Payment method</h2>
      <!-- <label for="balance-code">Your available balance</label>
      <div class="balance-input">
        <input type="text" id="balance-code" style="border: 1px solid #f2f2f2;" placeholder="Enter code">
        <button class="apply-btn">Apply</button> -->
      <!-- </div>   -->
    </div>

    <!-- UPI + Other Payment Methods (Side by Side) -->
    <div class="method-row" style="display: flex; gap: 2rem; margin-top: 1.5rem;">
      <div class="method-group" style="flex: 1 1 300px; min-width: 280px; height: 185px;">
        <h4 style="font-size:16px; font-weight:600;">UPI</h4>
        <label><input type="radio" name="payment" value="amazon_upi"> Amazon Pay UPI</label>
        <label><input type="radio" name="payment" value="bob_upi"> Bank of Baroda *5771</label>
      </div>

      <div class="method-group" style="flex: 1 1 300px; min-width: 280px; height: 185px;">
        <h4 style="font-size:16px; font-weight:600;">Other Payment Methods</h4>
        <label><input type="radio" name="payment" value="card"> Credit/Debit Card</label>
        <label><input type="radio" name="payment" value="netbanking"> Net Banking</label>
        <label><input type="radio" name="payment" value="other_upi"> Other UPI Apps</label>
        <label><input type="radio" name="payment" value="emi"> EMI</label>
      </div>
    </div>

    <!-- Cash on Delivery (Bottom) -->
    <div class="method-group disabled" style="opacity: 0.6; cursor: not-allowed; margin-top: 1rem; max-height: fit-content;">
      <label><input type="radio" disabled> Cash on Delivery / Pay on Delivery (Unavailable)</label>
    </div>

  </div>
</div>

{% endif %}

<style>
.items-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  background-color: #ffffff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.05);
  font-family: 'Inter', sans-serif;
  transition: box-shadow 0.3s ease, transform 0.3s ease;
}

/* Table Hover Lift */
.items-table:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.08);
}

/* Table Head */
.items-table thead {
  background-color: #f3f4f6;
  border-bottom: 2px solid #e5e7eb;
}

.items-table thead th {
  padding: 0.75rem 1rem;
  font-size: 0.85rem;
  font-weight: 600;
  color: #374151;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  transition: color 0.3s ease;
}

.items-table thead th:hover {
  color: #111827;
}

/* Table Body */
.items-table tbody td {
  padding: 0.75rem 1rem;
  font-size: 0.9rem;
  color: #1f2937;
  vertical-align: middle;
  border-top: 1px solid #e5e7eb;
  transition: color 0.3s ease;
}

.items-table tbody td:hover {
  color: #000000;
}

/* Item Cell with Image */
.items-table td:first-child {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

/* Item Image */
.items-table .item-img {
  width: 48px;
  height: 48px;
  object-fit: cover;
  border-radius: 6px;
  border: 1px solid #e5e7eb;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.items-table .item-img:hover {
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

/* Description Text */
.items-table td small {
  display: block;
  font-size: 0.8rem;
  color: #6b7280;
  margin-top: 2px;
  transition: color 0.3s ease;
}

.items-table td small:hover {
  color: #4c1d95;
}

/* Hover Row */
.items-table tbody tr {
  transition: background-color 0.3s ease, transform 0.2s ease;
}

.items-table tbody tr:hover {
  background-color: #f9fafb;
  transform: scale(1.01);
}

/* Alignment Helpers */
.items-table .text-start {
  text-align: left;
}

.items-table .text-center {
  text-align: center;
}

.items-table .text-end {
  text-align: right;
}

.items-table .px-0 {
  padding-left: 0 !important;
  padding-right: 0 !important;
}

</style>

    <table class="items-table rounded shadow ">
        <thead class="rounded">
            <tr>
                <th class="text-start ">Item</th>
                <th class="text-center px-0">Quantity</th>
                <th class="text-center px-0">Rate</th>
                <th class="text-end">Amount</th>
            </tr>
        </thead>
        <tbody>
            {% for d in doc.items %}
            <tr>
                <td style="display: flex; align-items: center;">
                    {% set website_item_list = frappe.get_all("Website Item", filters={"item_code": d.item_code}, limit=1) %}
                    {% if website_item_list %}
                        {% set website_item = frappe.get_doc("Website Item", website_item_list[0].name) %}
                        {% if website_item.website_image %}
                            <img src="{{ website_item.website_image }}" class="item-img" alt="{{ d.item_code }}">
                        {% endif %}
                    {% endif %}
                    <div>
                        {{ d.item_name }}<br>
                        <small class="text-black">{{ d.description }}</small>
                    </div>
                </td>
                <td class="text-center px-0">{{ d.get_formatted("qty") }}</td>
                <td class="text-center px-0">{{ d.get_formatted("rate") }}</td>
                <td class="text-end">{{ d.get_formatted("amount") }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
  </div>

  <style>
.card {
  background: rgba(255, 255, 255, 0.65);
  border-radius: 1.25rem;
  backdrop-filter: blur(14px) saturate(120%);
  box-shadow: 0 12px 32px rgba(0, 0, 0, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.25);
  transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1),
              box-shadow 0.5s ease,
              background 0.5s ease;
}

.card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: 0 18px 48px rgba(0, 0, 0, 0.15);
  background: rgba(255, 255, 255, 0.75);
}

/* Badge */
.badge {
  font-size: 0.8rem;
  font-weight: 600;
  text-transform: uppercase;
  border-radius: 999px;
  padding: 0.45rem 1.2rem;
  background: rgba(255, 255, 255, 0.85);
  color: #6f42c1;
  border: 1px solid #6f42c1;
  box-shadow: 0 2px 8px rgba(111, 66, 193, 0.15);
  transition: all 0.4s ease;
}

.badge:hover {
  background: #6f42c1;
  color: #ffffff;
  transform: scale(1.05);
}

/* Grand Total */
.card-body h3 {
  font-size: 2.2rem;
  font-weight: 700;
  color: #111827;
  margin-bottom: 0;
  transition: color 0.4s ease, transform 0.4s ease;
}

.card-body h3:hover {
  color: #6f42c1;
  transform: scale(1.05);
}

/* Pay Button */
.card-body .btn {
  background: linear-gradient(90deg, #6f42c1, #9b59b6);
  border: none;
  color: #ffffff;
  font-size: 1rem;
  font-weight: 600;
  padding: 0.8rem 1.2rem;
  border-radius: 12px;
  box-shadow: 0 6px 20px rgba(111, 66, 193, 0.25);
  transition: all 0.4s ease;
  position: relative;
  overflow: hidden;
}

.card-body .btn::after {
  content: "";
  position: absolute;
  top: 0;
  left: -120%;
  width: 120%;
  height: 100%;
  background: linear-gradient(90deg, rgba(255,255,255,0.25), rgba(255,255,255,0));
  transform: skewX(-20deg);
  transition: left 0.6s ease;
}

.card-body .btn:hover::after {
  left: 120%;
}

.card-body .btn:hover {
  transform: translateY(-3px) scale(1.03);
  box-shadow: 0 10px 28px rgba(111, 66, 193, 0.35);
}

  </style>
     {#<div class="header-bar shadow col-md-3 col-12" style="margin-left: 54px;height: fit-content;">
      <div class="col-md-6 mb-2">
        <div class="badge bg-info text-light p-2 text-uppercase me-2" style="border: 1px solid #590088;
    background: #ffffff !important;
    color: #000000 !important;">
          {{ _(doc.get('indicator_title')) or _(doc.status) or _("Submitted") }}
        </div>
        <div class=" mt-2 small">
          {{ frappe.utils.format_date(doc.transaction_date, "medium") }}
          {% if doc.valid_till %}
            • {{ _("Valid Till") }}: {{ frappe.utils.format_date(doc.valid_till, "medium") }}
          {% endif %}
        </div>
      </div>
       <!-- Taxes & Payment Summary -->
        <div class="mb-4">
            {% include "webshop/templates/includes/order/order_taxes.html" %}
        </div>
        <div class="col-md-12 text-start">

        <h5 class="mb-0">
          {%- set party_name = doc.supplier_name if doc.doctype in ['Supplier Quotation', 'Purchase Invoice', 'Purchase Order'] else doc.customer_name -%}
          {{ party_name }}
        </h5>
        {% if doc.contact_display and doc.contact_display != party_name %}
        <div class="text-muted small">{{ doc.contact_display }}</div>
        {% endif %}
        {% if enabled_checkout and (doc.doctype != "Sales Invoice" or doc.outstanding_amount > 0) %}
          <a href="/api/method/erpnext.accounts.doctype.payment_request.payment_request.make_payment_request?dn={{ doc.name }}&dt={{ doc.doctype }}&submit_doc=1&order_type=Shopping Cart" class="btn btn-sm btn-success mt-2 w-100" style="border: 1px solid aqua;
    background: aqua !important;
    color: #fff !important;">
            <b>{{ _("Pay") }} {{ doc.get_formatted("grand_total") }}</b>
          </a>
        {% endif %}
      </div>
    </div>#}
   <div class="card shadow-lg border-0 rounded-4 mt-4 col-md-3 col-12 mx-auto" 
     style="    height: fit-content;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef); 
            color: #1a1a1a; 
            min-height: fit-content;
            margin-left: 54px;
            transition: all 0.3s ease;
     ">

  <div class="card-body p-4">

    <!-- Status Badge & Date -->
    <div class="mb-3">
      <span class="badge border border-primary text-primary fw-semibold text-uppercase px-3 py-1 rounded-pill" 
            style="background: #fff; color: #6f42c1; border-color: #6f42c1;">
        {{ _(doc.workflow_state) or _("Submitted") }}
      </span>
      <p class="mt-3 small text-muted">
        {{ frappe.utils.format_date(doc.transaction_date, "medium") }}
        {% if doc.valid_till %}
          • {{ _("Valid Till") }}: {{ frappe.utils.format_date(doc.valid_till, "medium") }}
        {% endif %}
      </p>
    </div>

    <!-- Grand Total -->
    <div class="mb-4">
      <p class="text-sm fw-medium text-secondary mb-1">{{ _("Grand Total") }}</p>
      <h3 class="fw-bold text-dark mb-0">{{ doc.get_formatted("grand_total") }}</h3>
    </div>

    <!-- Party Name -->
    <div class="mb-3">
      <h5 class="fw-semibold mb-0">
        {%- set party_name = doc.supplier_name if doc.doctype in ['Supplier Quotation', 'Purchase Invoice', 'Purchase Order'] else doc.customer_name -%}
        {{ party_name }}
      </h5>
      {% if doc.contact_display and doc.contact_display != party_name %}
        <div class="text-muted small">{{ doc.contact_display }}</div>
      {% endif %}
    </div>

    <!-- Taxes & Payment Summary -->
    <!--<div class="mb-4">
      {% include "webshop/templates/includes/order/order_taxes.html" %}
    </div>-->

    <!-- Pay Button -->
    {% if enabled_checkout and (doc.doctype != "Sales Invoice" or doc.outstanding_amount > 0) and ("Corporate Buyer" not in roles)%}
      <a href="/api/method/erpnext.accounts.doctype.payment_request.payment_request.make_payment_request?dn={{ doc.name }}&dt={{ doc.doctype }}&submit_doc=1&order_type=Shopping Cart"
         class="btn w-100 fw-bold text-white"
         style="background: linear-gradient(90deg, #6f42c1, #9b59b6); border: none;">
         {{ _("Pay") }} {{ doc.get_formatted("grand_total") }}
      </a>
    {% endif %}

  </div>
</div>


    <!-- Loyalty Points -->
    {% if enabled_checkout and ((doc.doctype=="Sales Order" and doc.per_billed <= 0) or (doc.doctype=="Sales Invoice" and doc.outstanding_amount> 0)) %}
    
        {% if available_loyalty_points %}
		<div class="card shadow-sm mb-4 p-3">
        <h6 class="fw-bold mb-2">{{ _("Redeem Loyalty Points") }}</h6>
        <div class="d-flex align-items-center gap-3">
            <input class="form-control w-auto" type="number" min="0" max="{{ available_loyalty_points }}" id="loyalty-point-to-redeem">
            <small class="text-muted">Available Points: {{ available_loyalty_points }}</small>
        </div>
		   </div>
        {% endif %}
 
    {% endif %}

    <!-- Attachments -->
    {% if attachments %}
    <div class="card shadow-sm mb-4 p-3">
        <h6 class="fw-bold mb-2">{{ _("Attachments") }}</h6>
        <ul class="list-unstyled mb-0">
            {% for attachment in attachments %}
            <li><a href="{{ attachment.file_url }}" target="_blank">{{ attachment.file_name }}</a></li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- Terms & Conditions -->
    {% if doc.terms %}
		<div class="card shadow-sm mb-4 p-3 text-muted">
			<h6 class="fw-bold mb-2">{{ _("Terms & Conditions") }}</h6>
			<p>{{ doc.terms }}</p>
		</div>
    {% endif %}

</div>

<style>
.order-item-row:hover {
    background-color: #f9f9f9;
}
.order-image img {
    max-width: 60px;
    max-height: 60px;
    object-fit: cover;
    border-radius: 4px;
}
</style>
{% endblock %}

{% block script %}
	<script> {% include "templates/pages/order.js" %}</script>
	<script>
		window.doc_info = {
			customer: '{{doc.customer}}',
			doctype: '{{ doc.doctype }}',
			doctype_name: '{{ doc.name }}',
			grand_total: '{{ doc.grand_total }}',
			currency: '{{ doc.currency }}'
		}
	</script>
	<script>
	document.addEventListener("DOMContentLoaded", function () {
		const element = document.querySelector('.container');
		const element2 = document.querySelector('.container .my-4');
		const breadcrumbs = document.querySelector('.page-breadcrumbs');
		const header = document.querySelector('.page-header');
		const pageheader = document.querySelector('.page-header-wrapper');

		if (pageheader){
			pageheader.classList.add('p-0');
		}
		if (header){
			header.style.width = "100%";
		}
		if (breadcrumbs) {
			breadcrumbs.style.display = "none";
		}
		if (element) {
			element.classList.remove('container');
			element.classList.remove('my-4');
			}
		if (element2) {
		element2.classList.remove('container');
		element2.classList.add('container-fluid');
		element2.classList.add('p-0');
		element2.classList.remove('my-4');
		element.classList.add('bg-white');
		}
     }
  )
  frappe.ready(() => {
    const msg = localStorage.getItem("order_message");
    if (msg) {
        frappe.msgprint({
            title: "Order Submitted",
            message: msg,
            indicator: "green"
        });
        localStorage.removeItem("order_message");
    }
});

</script>
{% endblock %} 
